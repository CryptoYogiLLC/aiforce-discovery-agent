# =============================================================================
# AIForce Discovery Agent - Environment Variables
# =============================================================================
# Copy this file to .env and fill in your values
# NEVER commit .env to version control

# =============================================================================
# INFRASTRUCTURE
# =============================================================================

# RabbitMQ
RABBITMQ_PASSWORD=changeme_rabbitmq_password
RABBITMQ_URL=amqp://discovery:${RABBITMQ_PASSWORD}@rabbitmq:5672/

# PostgreSQL (for approval gateway)
POSTGRES_USER=discovery
POSTGRES_PASSWORD=changeme_postgres_password
POSTGRES_DB=discovery_agent
POSTGRES_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}

# Redis (for session caching)
REDIS_URL=redis://redis:6379

# =============================================================================
# DISCOVERY AGENT TOKEN
# =============================================================================
# Token for authenticating with AIForce Assess platform
# Obtain from: AIForce Assess > Settings > Discovery Agent

DISCOVERY_AGENT_TOKEN=your_token_here

# =============================================================================
# COLLECTOR CONFIGURATION
# =============================================================================

# Network Scanner
NETWORK_SCAN_ENABLED=true
NETWORK_SCAN_SUBNETS=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16
NETWORK_SCAN_EXCLUDE_SUBNETS=
NETWORK_SCAN_PORTS=22,80,443,3306,5432,27017,6379,8080,8443

# Code Analyzer
CODE_ANALYZER_ENABLED=false
CODE_REPO_PATHS=/repos
CODE_INCLUDE_PATTERNS=*.java,*.py,*.go,*.ts,*.js,*.cs
CODE_EXCLUDE_PATTERNS=**/node_modules/**,**/vendor/**,**/.git/**

# Database Inspector
DB_INSPECTOR_ENABLED=false
# Connection strings for databases to inspect (comma-separated)
DB_CONNECTIONS=

# =============================================================================
# DATA HANDLING
# =============================================================================

# PII Redaction
REDACT_EMAILS=true
REDACT_IPS=true
REDACT_HOSTNAMES=false
REDACT_USERNAMES=true
REDACT_CUSTOM_PATTERNS=

# =============================================================================
# TRANSMISSION
# =============================================================================

# Transmission mode: approval_required | auto_transmit | collect_only
TRANSMISSION_MODE=approval_required

# AIForce Assess API endpoint
AIFORCE_API_URL=https://api.aiforce-assess.com

# Batch size for transmission
TRANSMISSION_BATCH_SIZE=100

# =============================================================================
# LOGGING & MONITORING
# =============================================================================

LOG_LEVEL=INFO
LOG_FORMAT=json

# Optional: External logging
# LOKI_URL=http://loki:3100
# JAEGER_URL=http://jaeger:14268

# =============================================================================
# DEVELOPMENT ONLY
# =============================================================================

# Set to true to enable debug endpoints
DEBUG_MODE=false

# Mock external services for testing
MOCK_AIFORCE_API=false
